{% extends "dashboard/base.html" %}
{% load static %}

{% block content %}
<div class="container content-wrapper">
  
  <!-- Judul Halaman -->
  <h3 class="mb-3">Riwayat Permohonan </h3>

  <!-- Tabel Data -->
  <div class="card shadow-sm">
    <div class="card-body">
      <table class="table table-bordered table-hover">
        <thead class="table-dark">
          <tr class="text-center">
            <th style="width:5%;">No</th>
            <th>Nama Pemohon</th>
            <th>Tanggal Kirim</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for item in data %}
          <tr>
            <td class="text-center">{{ forloop.counter }}</td>
            <td>{{ item.nama_pemohon }}</td>
            <td>{{ item.tanggal_permohonan|date:"d M Y" }}</td>
            <td class="text-center">
              {% if item.status_rekomtek.all %}
                {% with last_status=item.status_rekomtek.last.status %}
                  {% if last_status == "diterima" %}
                    <span class="badge bg-success">Diterima</span>
                  {% elif last_status == "ditolak" %}
                    <span class="badge bg-danger">Ditolak</span>
                  {% elif last_status == "proses" %}
                    <span class="badge bg-warning text-dark">Proses</span>
                  {% else %}
                    <span class="badge bg-secondary">{{ last_status }}</span>
                  {% endif %}
                {% endwith %}
              {% else %}
                <span class="badge bg-secondary">Belum Ada Status</span>
              {% endif %}
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-center text-muted">Belum ada data permohonan</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Tombol Kembali ke Dashboard -->
  <div class="mt-3">
    <a href="{% url 'dashboard' %}" class="btn btn-secondary">
      <i class="fas fa-arrow-left"></i> Kembali ke Dashboard
    </a>
  </div>

</div>

<style>
  /* Supaya konten tidak nabrak navbar */
  .content-wrapper {
    margin-top: 100px;  /* sesuaikan dengan tinggi navbar */
  }
</style>
{% endblock %}
